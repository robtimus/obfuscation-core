<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 1.11.1 from src/site/markdown/examples.md at 2023-10-01
 | Rendered using Apache Maven Fluido Skin 1.11.2
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.11.1" />
    <title>obfuscation-core &#x2013; Examples</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.11.2.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-1.11.2.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h1>obfuscation-core</h1>
</div>
</div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2023-10-01<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 1.5</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">obfuscation-core</li>
    <li><a href="index.html" title="Overview"><span class="none"></span>Overview</a></li>
    <li class="active"><a><span class="none"></span>Examples</a></li>
    <li><a href="download.html" title="Download"><span class="none"></span>Download</a></li>
    <li><a href="https://github.com/robtimus/obfuscation-core/releases" class="externalLink" title="Releases"><span class="none"></span>Releases</a></li>
    <li><a href="apidocs/index.html" title="Javadoc"><span class="none"></span>Javadoc</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >

<section>
<h2><a name="Obfuscating_all_characters"></a>Obfuscating all characters</h2>

<div class="source"><pre class="prettyprint"><code>CharSequence obfuscated = Obfuscator.all().obfuscateText(&quot;Hello World&quot;);
// obfuscated represents &quot;***********&quot;
</code></pre></div>
<p>Note: using this obfuscator still leaks out information about the length of the original text. One of the following two is more secure.</p></section><section>
<h2><a name="Obfuscating_with_a_fixed_length"></a>Obfuscating with a fixed length</h2>

<div class="source"><pre class="prettyprint"><code>CharSequence obfuscated = Obfuscator.fixedLength(5).obfuscateText(&quot;Hello World&quot;);
// obfuscated represents &quot;*****&quot;
</code></pre></div></section><section>
<h2><a name="Obfuscating_with_a_fixed_value"></a>Obfuscating with a fixed value</h2>

<div class="source"><pre class="prettyprint"><code>CharSequence obfuscated = Obfuscator.fixedValue(&quot;foo&quot;).obfuscateText(&quot;Hello World&quot;);
// obfuscated represents &quot;foo&quot;
</code></pre></div></section><section>
<h2><a name="Obfuscating_portions_of_text"></a>Obfuscating portions of text</h2>
<p>While the above examples are simple, they are not very flexible. Using <code>Obfuscator.portion</code> you can build obfuscators that obfuscate only specific portions of text. Some examples:</p><section>
<h3><a name="Obfuscating_all_but_the_last_4_characters"></a>Obfuscating all but the last 4 characters</h3>
<p>Useful for obfuscating values like credit card numbers.</p>

<div class="source"><pre class="prettyprint"><code>CharSequence obfuscated = Obfuscator.portion()
        .keepAtEnd(4)
        .build()
        .obfuscateText(&quot;1234567890123456&quot;);
// obfuscated represents &quot;************3456&quot;
</code></pre></div>
<p>It's advised to use <code>atLeastFromStart</code>, to make sure that values of fewer than 16 characters are still obfuscated properly:</p>

<div class="source"><pre class="prettyprint"><code>CharSequence obfuscated = Obfuscator.portion()
        .keepAtEnd(4)
        .atLeastFromStart(12)
        .build()
        .obfuscateText(&quot;1234567890&quot;);
// obfuscated represents &quot;**********&quot; and not &quot;******7890&quot;
</code></pre></div></section><section>
<h3><a name="Obfuscating_only_the_last_2_characters"></a>Obfuscating only the last 2 characters</h3>
<p>Useful for obfuscating values like zip codes, where the first part is not as sensitive as the full zip code:</p>

<div class="source"><pre class="prettyprint"><code>CharSequence obfuscated = Obfuscator.portion()
        .keepAtStart(Integer.MAX_VALUE)
        .atLeastFromEnd(2)
        .build()
        .obfuscateText(&quot;SW1A 2AA&quot;);
// obfuscated represents &quot;SW1A 2**&quot;
</code></pre></div>
<p>Here, the <code>keepAtStart</code> instructs the obfuscator to keep everything; however, <code>atLeastFromEnd</code> overrides that partly to ensure that the last two characters are obfuscated regardless of the value specified by <code>keepAtStart</code>.</p></section><section>
<h3><a name="Using_a_fixed_length"></a>Using a fixed length</h3>
<p>Similar to using <code>Obfuscator.all</code>, by default an obfuscator built using <code>Obfuscator.portion</code> leaks out the length of the original text.
If your text has a variable length, you should consider specifying a fixed total length for the result. The length of the result will then be the same no matter how long the input is:</p>

<div class="source"><pre class="prettyprint"><code>Obfuscator obfuscator = Obfuscator.portion()
        .keepAtStart(2)
        .keepAtEnd(2)
        .withFixedTotalLength(6)
        .build();
CharSequence obfuscated = obfuscator.obfuscateText(&quot;Hello World&quot;);
// obfuscated represents &quot;He**ld&quot;
obfuscated = obfuscator.obfuscateText(&quot;foo&quot;);
// obfuscated represents &quot;fo**oo&quot;
</code></pre></div>
<p>Note that if <code>keepAtStart</code> and <code>keepAtEnd</code> are both specified, parts of the input may be repeated in the result if the input's length is less than the combined number of characters to keep. This makes it harder to find the original input. For example, if in the example <code>foo</code> would be obfuscated into <code>fo***o</code> instead, it would be clear that the input was <code>foo</code>. Instead, it can now be anything that starts with <code>fo</code> and ends with <code>oo</code>.</p></section></section><section>
<h2><a name="Using_a_predefined_function"></a>Using a predefined function</h2>
<p>Assuming the current class has a method <code>CharSequence obfuscate(CharSequence s)</code>:</p>

<div class="source"><pre class="prettyprint"><code>Obfuscator obfuscator = Obfuscator.fromFunction(this::obfuscate);
CharSequence obfuscated = obfuscator.obfuscateText(&quot;Hello World&quot;);
// obfuscated is the result of calling obfuscate(&quot;Hello World&quot;)
</code></pre></div>
<p>Note that the input argument needs to be either <code>CharSequence</code> or <code>Object</code>; the return type of the method may be a sub type of <code>CharSequence</code> like <code>String</code> or <code>StringBuilder</code>.</p>
<p>If the method's input argument is instead <code>String</code> you need to use a lambda that calls <code>toString()</code> on its argument before passing it to the method:</p>

<div class="source"><pre class="prettyprint"><code>Obfuscator obfuscator = Obfuscator.fromFunction(s -&gt; obfuscate(s.toString()));
CharSequence obfuscated = obfuscator.obfuscateText(&quot;Hello World&quot;);
// obfuscated is the result of calling obfuscate(&quot;Hello World&quot;.toString())
</code></pre></div></section><section>
<h2><a name="Obfuscating_objects"></a>Obfuscating objects</h2>

<div class="source"><pre class="prettyprint"><code>LocalDate date = LocalDate.of(2020, 1, 1);
Obfuscated&lt;LocalDate&gt; obfuscated = Obfuscator.portion()
        .keepAtStart(8)
        .build()
        .obfuscateObject(date);
// obfuscated.toString() returns &quot;2020-01-**&quot;
// the date itself can be retrieved using obfuscated.value()
</code></pre></div>
<p>In this example, the obfuscation will always be the same. That means that the result of obfuscation can be cached, to prevent it from being recalculated every time:</p>

<div class="source"><pre class="prettyprint"><code>LocalDate date = LocalDate.of(2020, 1, 1);
Obfuscated&lt;LocalDate&gt; obfuscated = Obfuscator.portion()
        .keepAtStart(8)
        .build()
        .obfuscateObject(date)
        .cached();
// obfuscated.toString() returns the same string instance every time it's called
</code></pre></div></section><section>
<h2><a name="Obfuscating_collections"></a>Obfuscating collections</h2>

<div class="source"><pre class="prettyprint"><code>List&lt;String&gt; list = new ArrayList&lt;&gt;();
list.add(&quot;hello&quot;);
list.add(&quot;world&quot;);
list = Obfuscator.fixedLength(3).obfuscateList(list);
// list is just like any other List, apart from toString;
// that returns &quot;[***, ***]&quot;

Set&lt;String&gt; set = new HashSet&lt;&gt;();
set.add(&quot;hello&quot;);
set.add(&quot;world&quot;);
set = Obfuscator.fixedLength(3).obfuscateSet(set);
// list is just like any other Set, apart from toString;
// that returns &quot;[***, ***]&quot;

Collection&lt;String&gt; collection = new ArrayList&lt;&gt;();
collection.add(&quot;hello&quot;);
collection.add(&quot;world&quot;);
collection = Obfuscator.fixedLength(3).obfuscateCollection(collection);
// list is just like any other Collection, apart from toString;
// that returns &quot;[***, ***]&quot;
</code></pre></div></section><section>
<h2><a name="Obfuscating_maps"></a>Obfuscating maps</h2>
<p>To obfuscate each value the same way:</p>

<div class="source"><pre class="prettyprint"><code>Map&lt;String, String&gt; map = new LinkedHashMap&lt;&gt;();
map.put(&quot;username&quot;, &quot;admin&quot;);
map.put(&quot;password&quot;, &quot;hello&quot;);
map = Obfuscator.fixedLength(3).obfuscateMap(map);
// map is just like any other Map, apart from toString;
// that returns &quot;{username=***, password=***}&quot;
</code></pre></div>
<p>To provide separate obfuscation per entry:</p>

<div class="source"><pre class="prettyprint"><code>Map&lt;String, String&gt; map = new LinkedHashMap&lt;&gt;();
map.put(&quot;username&quot;, &quot;admin&quot;);
map.put(&quot;password&quot;, &quot;hello&quot;);
map = MapObfuscator.&lt;String, String&gt;builder()
        .withKey(&quot;password&quot;, Obfuscator.fixedLength(3))
        .build()
        .obfuscateMap(map);
// map is just like any other Map, apart from toString;
// that returns &quot;{username=admin, password=***}&quot;
</code></pre></div></section><section>
<h2><a name="Obfuscating_Properties_objects:"></a>Obfuscating Properties objects:</h2>

<div class="source"><pre class="prettyprint"><code>Properties properties = new Properties();
properties.put(&quot;username&quot;, &quot;admin&quot;);
properties.put(&quot;password&quot;, &quot;hello&quot;);
properties = PropertiesObfuscator.builder()
        .withProperty(&quot;password&quot;, Obfuscator.fixedLength(3))
        .build()
        .obfuscateProperties(properties);
// properties is just like any other Properties, apart from:
// - toString; that returns &quot;{username=admin, password=***}&quot;
//   or &quot;{password=***, username=admin}&quot;
// - list; that prints &quot;username=admin&quot; and &quot;password=***&quot;
</code></pre></div></section><section>
<h2><a name="Streaming_obfuscation"></a>Streaming obfuscation</h2>

<div class="source"><pre class="prettyprint"><code>// assume that writer is an existing Writer
Obfuscator obfuscator = Obfuscator.portion()
        .keepAtStart(24)
        .withFixedTotalLength(27)
        .build();
try (Writer obfuscatingWriter = obfuscator.streamTo(writer)) {
    obfuscatingWriter.write(&quot;username=admin&quot;);
    obfuscatingWriter.write(&quot;&amp;password=hello&quot;);
}
// &quot;username=admin&amp;password=***&quot; has been written to writer
// note that writer has not been closed at this point
</code></pre></div></section><section>
<h2><a name="Combining_obfuscators"></a>Combining obfuscators</h2>
<p>Sometimes the obfucators in this library alone cannot perform the obfuscation you need. For instance, if you want to obfuscate credit cards, but keep the first and last 4 characters. If the credit cards are all fixed length, <code>Obfuscator.portion</code> can do just that:</p>

<div class="source"><pre class="prettyprint"><code>Obfuscator obfuscator = Obfuscator.portion()
        .keepAtStart(4)
        .keepAtEnd(4)
        .build();
CharSequence obfuscated = obfuscator.obfuscateText(&quot;1234567890123456&quot;);
// obfuscated represents &quot;1234********3456&quot;
</code></pre></div>
<p>However, if you attempt to use such an obfuscator on only a part of a credit card, you could end up leaking parts of the credit card that you wanted to obfuscate:</p>

<div class="source"><pre class="prettyprint"><code>CharSequence incorrectlyObfuscated = obfuscator.obfuscateText(&quot;12345678901234&quot;);
// incorrectlyObfuscated represents &quot;1234******1234&quot; where &quot;1234********34&quot; would probably be preferred
</code></pre></div>
<p>To overcome this issue, it's possible to combine obfuscators. The form is as follows:</p>
<ul>

<li>Specify the first obfuscator, and the input length to which it should be used.</li>
<li>Specify any other obfuscators, and the input lengths to which they should be used. Note that each input length should be larger than the previous input length.</li>
<li>Specify the obfuscator that will be used for the remainder.</li>
</ul>
<p>For instance, for credit card numbers of exactly 16 characters, the above can also be written like this:</p>

<div class="source"><pre class="prettyprint"><code>Obfuscator obfuscator = Obfuscator.none().untilLength(4)
        .then(Obfuscator.all()).untilLength(12)
        .then(Obfuscator.none());
</code></pre></div>
<p>With this chaining, it's now possible to keep the first and last 4 characters, but with at least 8 characters in between:</p>

<div class="source"><pre class="prettyprint"><code>Obfuscator obfuscator = Obfuscator.none().untilLength(4)
        .then(Obfuscator.portion()
                .keepAtEnd(4)
                .atLeastFromStart(8)
                .build());
CharSequence obfuscated = obfuscator.obfuscateText(&quot;12345678901234&quot;);
// obfuscated represents &quot;1234********34&quot;
</code></pre></div></section><section>
<h2><a name="Splitting_text_during_obfuscation"></a>Splitting text during obfuscation</h2>
<p>To make it easier to create obfuscators for structured text like email addresses, use a <a href="apidocs/com/github/robtimus/obfuscation/Obfuscator.SplitPoint.html">SplitPoint</a>. For instance:</p>

<div class="source"><pre class="prettyprint"><code>// Keep the domain as-is
Obfuscator localPartObfuscator = Obfuscator.portion()
        .keepAtStart(1)
        .keepAtEnd(1)
        .withFixedTotalLength(8)
        .build();
Obfuscator domainObfuscator = Obfuscator.none();
Obfuscator obfuscator = Obfuscator.SplitPoint.atFirst('@').splitTo(localPartObfuscator, domainObfuscator);
CharSequence obfuscated = obfuscator.obfuscateText(&quot;test@example.org&quot;);
// obfuscated represents &quot;t******t@example.org&quot;
</code></pre></div>
<p>To obfuscate the domain except for the TLD, use a nested <code>SplitPoint</code>:</p>

<div class="source"><pre class="prettyprint"><code>// Keep only the TLD of the domain
Obfuscator localPartObfuscator = Obfuscator.portion()
        .keepAtStart(1)
        .keepAtEnd(1)
        .withFixedTotalLength(8)
        .build();
Obfuscator domainObfuscator = Obfuscator.SplitPoint.atLast('.').splitTo(Obfuscator.all(), Obfuscator.none());
Obfuscator obfuscator = Obfuscator.SplitPoint.atFirst('@').splitTo(localPartObfuscator, domainObfuscator);
CharSequence obfuscated = obfuscator.obfuscateText(&quot;test@example.org&quot;);
// obfuscated represents &quot;t******t@*******.org&quot;
</code></pre></div></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>&#169;      2020&#x2013;2023
</p>
        </div>
      </div>
    </footer>
<script>
	if(anchors) {
	  anchors.add();
	}
</script>
  </body>
</html>
